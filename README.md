# 가치 편지 (Question and Answer With Me)

커플/연인을 위한 질문 기반 편지 웹앱입니다.  
실제로 편지를 보내는 흐름처럼, 질문에 답하며 서로의 가치관을 나누는 것을 목표로 합니다.

## 1. 프로젝트 개요

- 서비스명: 가치 편지
- 컨셉: 실시간으로 써 내려가는 편지 경험
- 대상: 커플/연인
- 핵심 가치: 서로의 생각, 돈/일/가족/갈등/미래 가치관을 구조화된 질문으로 공유

## 2. 기술 스택

- Frontend: Next.js (App Router), TypeScript
- UI: Tailwind CSS, shadcn/ui (Headless UI 기반 공통 컴포넌트)
- Data Fetching: axios, TanStack Query
- API: Next.js Route Handlers (`app/api/*`)
- Auth/DB: Firebase Authentication (Google), Firestore
- Deploy: Vercel (서버리스)

## 3. MVP 기능 범위

1. 첫 접속 화면
- 문구: `가치 편지, 같이 써볼까요?`
- 버튼: `구글 로그인하기`

2. 로그인 후 인트로 슬라이드
- 문장 3개를 천천히 순차 노출:
  - `1시간동안 편하게 나와 상대방을 생각하면서 써봐요.`
  - `상대방에게 나의 가치를 전달해보세요.`
  - `자, 그럼 같이 써볼까요?`
- 문장 출력 완료 후 질문 작성 시작 가능

3. 질문 작성 플로우
- 대제목(고정) + 질문별 텍스트 입력
- 각 답변 1500자 제한
- `다음` 클릭 시 DB 저장

4. 제출 마무리 플로우
- 마지막에 상대 이메일 입력
- 제출 직후 문구: `상대에게 가치 편지를 보내고 있어요`
- 저장 완료 후 최소 3초 뒤 문구 변경: `상대의 편지를 기다리고 있어요`

5. 편지 수신/열람
- 상대가 내 이메일을 수신자로 입력하면 내 수신함에서 확인
- 최초 1회 알림 문구: `*** 님이 가치 편지를 보냈어요`
- `읽어보기` 클릭 시 질문지 형태로 열람
- 각 문항에서:
  - 위: 상대 답변
  - 아래: 내가 작성한 동일 문항 답변

## 4. 질문 문항 (고정)

### 1) 우리는 왜 돈을 벌고 있을까?
- 돈이 나에게 어떤 감정을 준다고 생각해? (안정, 자유, 인정, 선택권 등)
- 부자가 되고 싶다고 말한다면, 그 “부자”는 어떤 사람일까?
- 나에게 돈이 충분하다고 느끼는 기준은 무엇일까?

### 2) 직업은 나에게 어떤 의미일까?
- 지금 직업은 나의 정체성과 얼마나 연결되어 있을까?
- 직업이 사라진다면 나는 어떤 사람이 될 것 같아? 이후에 어떤 일을 할까?
- 직업 없이도 내가 나라고 느낄 수 있는 요소는 뭐야?

### 3) 은퇴와 자유에 대한 생각
- 나는 몇 살쯤 노동 강도를 줄이고 싶어?
- 그때 자산은 어느 정도면 마음이 편할 것 같아?
- 월 얼마 정도의 현금 흐름이면 불안하지 않을까?
- 완전 은퇴 vs 반(半)자유, 나는 어느 쪽이 더 맞을까?

### 4) 우리가 그리고 싶은 가족의 모습
- 자녀가 어떤 성격으로 자랐으면 좋겠어?
- 자녀에게 삶에서 중요한 가치는 뭐라고 알려주고 싶어?
- 우리가 아이에게 주고 싶은 것은 어떤게 있을까? (성취, 경험, 태도, 환경 등)
- 나는 부모로서 어떤 사람이고 싶어?

### 5) 우리의 중심 가치
- 지금 나에게 가장 중요한 가치는 무엇일까? (자유, 안정, 사랑, 성장, 균형, 평온 등)
- 우리는 무엇을 잃어도 괜찮고, 무엇은 절대 잃고 싶지 않을까?
- 우리가 힘들어질 때 돌아와야 할 기준은 무엇일까? (행동이나 상태)

### 6) 갈등과 화해 방식
- 나는 화가 나면 어떻게 행동하는 편이야?
- 혼자 시간이 필요하다면 얼마나 필요할까?
- 내가 “이제 괜찮아”라는 신호는 어떤걸까?
- 우리가 안전하다고 느끼는 싸움 방식은 어떤 걸까?

### 7) 돈이 충분하다면 해보고 싶은 것 세 가지 (현실과 이상 사이 어딘가)
- 당장 1–2년 안에 실험해볼 수 있는 것
- 10년 안에 꼭 해보고 싶은 것
- 은퇴 이후에 해보고 싶은 것
- 삶의 최종 가치와 목표

### 8) 우리 부부가 오래 가기 위해 가장 중요한 한 가지
- 부부 사이에 가장 중요하게 생각하는 것은?
- 상대가 나에게 꼭 지켜줬으면 하는 태도는?
- 우리가 서로에게 해줄 수 있는 가장 기본적인 약속은?

## 5. 화면/라우팅 구조

- `/` : 랜딩 + 구글 로그인
- `/intro` : 인트로 슬라이드
- `/write` : 질문 작성
- `/waiting` : 전송 중/대기 문구
- `/inbox` : 수신된 편지 목록/알림
- `/letters/[id]` : 상대 답변 + 내 답변 비교 열람

## 6. Firestore 데이터 모델 (제안)

### `users`
- `uid`
- `email`
- `displayName`
- `photoURL`
- `createdAt`

### `letters`
- `id`
- `fromUid`
- `fromEmail`
- `toEmail`
- `answers: { sectionId, questionId, answerText }[]`
- `status: draft | sent`
- `createdAt`
- `updatedAt`
- `sentAt`

### `receipts` (최초 1회 알림 제어)
- `id` (`${letterId}_${receiverUid}`)
- `letterId`
- `receiverUid`
- `notified` (boolean)
- `seenAt` (timestamp | null)

## 7. API 설계 (Next.js Route Handlers)

- `POST /api/letters`
  - 편지 생성/제출 저장
- `GET /api/letters/inbox`
  - 내 이메일 기준 수신함 조회
- `GET /api/letters/:id`
  - 편지 상세 + 내 답변 매칭 데이터 조회
- `POST /api/letters/:id/read`
  - 최초 1회 알림 확인 처리

## 8. 인증/권한

- Firebase Google 로그인 사용
- Firestore Rules 기본 원칙:
  - 사용자 본인 문서만 수정 가능
  - 편지 생성은 로그인 사용자만 가능
  - 수신 조회는 로그인한 이메일 기준으로 제한
  - 편지 상세 조회는 발신자/수신자만 허용

## 9. 개발 단계 계획

1. Next.js 프로젝트 초기 세팅 (Tailwind, shadcn/ui, Firebase)
2. 로그인/세션 처리 및 보호 라우트 구성
3. 질문 상수 데이터 구조화 (`constants/questions.ts`)
4. 작성 UI + 1500자 제한 + 저장 플로우 구현
5. 제출/대기 문구/3초 지연 처리 구현
6. 수신함 + 최초 1회 알림 처리 구현
7. 상세 비교 읽기 화면 구현
8. 권한 규칙/에러 처리/QA 후 Vercel 배포

## 10. 실행 메모

- 이메일 매칭 시 공백 제거 + 소문자 정규화 필요
- 긴 텍스트 입력 UX를 위해 글자 수 카운터 제공
- 전송 직후 로딩 상태와 재시도 UX를 반드시 제공

